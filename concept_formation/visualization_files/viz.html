<!DOCTYPE html>
<html>
  <head>
    <title>Trestle Viz</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>

    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="viz_styling.css">
  </head>
  <body>
  <div class="container-fluid">
  <div class="row">
      <div id="plot-panel" class="col-md-9 col-sm-8 col-xs-12">
        <div class="svg-container">
          <svg class="svg-content-responsive" viewBox="0 0 750 750" preserveAspectRatio="xMinYMin meet"></svg>
        </div>
      </div>
      <div id="property-container" class="col-md-3 col-sm-4 col-xs-6">
        <div id="property-panel">
          <h3>Current Concept</h3>
          <table class="table table-condensed">
            <tbody>
              <tr>
                <td class="concept-prop"><strong>Concept Name</strong></td>
                <td class="absorbing-column" id="concept-name"></td>
              </tr>
              <tr>
                <td class="concept-prop"><strong>Size</strong></td>
                <td class="absorbing-column" id="concept-size"></td>
              </tr>
              <tr>
                <td class="concept-prop"><strong>N Children</strong></td>
                <td class="absorbing-column" id="concept-child-size"></td>
              </tr>
            </tbody>
          </table>
          <h3>Search</h3>
          <div class="input-group">
            <input id="search-concept-name" type="text" class="form-control" placeholder="Concept#">
            <span class="input-group-btn">
              <button id="search-concept-go" class="btn btn-default" type="button">Search</button>
            </span>
          </div>
          <span id="search-not-found" class="text-danger"></span>

          <h3>Settings</h3>
          <!-- <label>Show Node Names<input id="show-names" type="checkbox"> </label><br>
          <label>Image Field
              <select id="img-attr">
                  <option value="none">None</option> 
              </select> 
          </label><br> -->
          <a class="btn btn-default btn-xs" role="button" data-toggle="collapse" href="#filter-props"><strong>Filter Properties</strong></a>
          <div class="collapse" id="filter-props">
              Select the properties types you want to filter out:
              <form id="filter-form">
                <div class="form-group">
                  <div class="checkbox"><label><input id="unq-filter" type="checkbox" >Unique Values</label></div>
                  <div class="checkbox"><label><input id="con-filter" type="checkbox" >Constant Values</label></div>
                  <div class="checkbox"><label><input id="rel-filter" type="checkbox" >Relations Attribtues</label></div>
                  <div class="checkbox"><label><input id="hid-filter" type="checkbox" >Hidden Attributes</label></div>
                  <div class="checkbox"><label><input id="com-filter" type="checkbox" >Component Property Attributes</label></div>
                </div>
              </form>
          </div><br>
          <h3>Attribute Explorer</h3>
          <label><strong>Focus Attribute</strong>
            <select id="focus-attr">
              <option value="none">None</option>
            </select>
          </label>
          <table class="table table-condensed">
            <tbody>
              <tr>
                <td class="concept-prop"><strong>Attribute Type</strong></td>
                <td class="absorbing-column" id="focus-attr-type">Default</td>
              </tr>
              <tr>
                <td class="concept-prop"><strong>Value Type</strong></td>
                <td class="absorbing-column" id="focus-val-type">Default</td>
              </tr>
            </tbody>
          </table>
          <div id="nominal-colors" class="color-ops">
            <table class="table table-condensed">
              <thead>
                <tr>
                  <td class="absorbing-column"><strong>Value</strong></td>
                  <td><strong>Color</strong></td>
                </tr>
              </thead>
              <tbody id="nom-val-colors">
              </tbody>
            </table>
          </div>
          <div id="numeric-colors" class="color-ops">
            <div class="progress">
              <div id="num-col-1" class="progress-bar num-swatch"></div>
              <div id="num-col-2" class="progress-bar num-swatch"></div>
              <div id="num-col-3" class="progress-bar num-swatch"></div>
              <div id="num-col-4" class="progress-bar num-swatch"></div>
              <div id="num-col-5" class="progress-bar num-swatch"></div>
              <div id="num-col-6" class="progress-bar num-swatch"></div>
              <div id="num-col-7" class="progress-bar num-swatch"></div>
              <div id="num-col-8" class="progress-bar num-swatch"></div>
              <div id="num-col-9" class="progress-bar num-swatch"></div>
            </div>
            <div class="row">
              <div id="num-val-1" class="col-md-4" style="text-align:left"></div>
              <div id="num-val-5" class="col-md-4" style="text-align:center"></div>
              <div id="num-val-9" class="col-md-4" style="text-align:right;"></div>
            </div>
          </div>
          <h3>Attribute-Value Table</h3>
          <table id="property-sheet" class="table table-bordered table-condensed av-table">
            <thead>
              <tr>
                <td class="prop-column"><b>Property</b></td>
                <td class="count-column"><b>Count</b></td>
                <td class="perc-column"><b>Percent</b></td>
              </tr>
            </thead>
            <tbody id="properties">
            </tbody>
          </table>
        </div>
    </div>
    </div>
    <div class="col-md-10">
      <script src="https://d3js.org/d3.v4.js"></script>
      <script src="https://d3js.org/d3-array.v1.min.js"></script>
      <script src="https://d3js.org/d3-collection.v1.min.js"></script>
      <script src="https://d3js.org/d3-color.v1.min.js"></script>
      <script src="https://d3js.org/d3-format.v1.min.js"></script>
      <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
      <script src="https://d3js.org/d3-time.v1.min.js"></script>
      <script src="https://d3js.org/d3-time-format.v2.min.js"></script>
      <script src="https://d3js.org/d3-scale.v2.min.js"></script>
      <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
      <script type="text/javascript" src="output.js"></script>
      <script type="text/javascript" src="viz_logic.js"></script>
      <script type="text/javascript">
        if(typeof trestle_output === 'undefined'){
          alert("Can't find the trestle output data. Use visualize(tree) to output an appropriate tree.");
        }
        else if (typeof d3 === 'undefined'){
          alert("Can't find the d3 library. Currently the viz assumes it can get it from a CDN on the internet.")
        }
        else {
          data = trestle_output;
          $("#focus-attr").change(colorSelectChanged);
          // $("#img-attr").change(imageSelectChanged);
          // $("#show-names").change(changeText);
          $("#com-filter").change(updateFilters);
          $("#con-filter").change(updateFilters);
          $("#rel-filter").change(updateFilters);
          $("#unq-filter").change(updateFilters);
          $("#hid-filter").change(updateFilters);
          $("#search-concept-go").click(searchConceptByName);
          $("#search-concept-name").change(searchConceptByName);
          init(data);
          colorSelectChanged();
          populateColorByOptions(data);
          buildTree(data);
          make_property_sheet(data);
        }
      </script>
    </div>
    </div>
  </body>
</html>